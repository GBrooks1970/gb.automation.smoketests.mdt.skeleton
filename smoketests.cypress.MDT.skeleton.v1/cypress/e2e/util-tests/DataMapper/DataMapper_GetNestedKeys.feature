@UTILTEST @DATAMAPPER
Feature: DataMapper - Retrieve all nested property keys from an object
    As a developer
    I want to test the DataMapper utility method getNestedKeys
    So that I can ensure the correct nested property paths are generated.

    Scenario Outline: DATAMAPPER-GETNESTEDKEYS-001 - DataMapper method Get nested keys from various objects
        Given I have the following object:
            """
            <inputObject>
            """
        When I call the DataMapper getNestedKeys method
        Then I should get the following nested property paths:
            """
            <expectedKeys>
            """

        Examples:
            | inputObject                                                                                                                                                                                                                                      | expectedKeys                                                                                                                           |
            | {"name":"John","age":30,"address":{"street":"123 St","city":"Metropolis"}}                                                                                                                                                                       | ["name","age","address.street","address.city"]                                                                                         |
            | {"user":{"profile":{"name":"Alice","contacts":{"email":"alice@mail.com"}}}}                                                                                                                                                                      | ["user.profile.name","user.profile.contacts.email"]                                                                                    |
            | {"employees":[{"name":"Bob","role":"Manager"}],"company":"TechCorp"}                                                                                                                                                                             | ["employees.1.name", "employees.1.role", "company"]                                                                                      |
            | {}                                                                                                                                                                                                                                               | []                                                                                                                                     |
            | {"product":{"details":{"name":"Phone","specs":{"ram":"8GB","storage":"128GB"}}}}                                                                                                                                                                 | ["product.details.name","product.details.specs.ram","product.details.specs.storage"]                                                   |
            | {"PID":"12345","Scheme":"ExampleScheme","Profile":{"Forenames":"John","Initials":"J"}}                                                                                                                                                           | ["PID","Scheme","Profile.Forenames","Profile.Initials"]                                                                                |
            | {"PostCode":"AB12CD","ReferenceDetails":{"RefereeName":"Jane","Address":{"AddressLines":["123 Street","City"]}}}                                                                                                                                 | ["PostCode","ReferenceDetails.RefereeName","ReferenceDetails.Address.AddressLines.1","ReferenceDetails.Address.AddressLines.2"]        |
            | {"AddressLines":["123 Street","City","State","Country"],"PostCode":"AB12CD"}                                                                                                                                                                     | ["AddressLines.1","AddressLines.2","AddressLines.3","AddressLines.4","PostCode"]                                                       |
            | {"Title":"Degree 1","MainSubject":"Math","AwardingBody":"University A","Month":"June","Year":"2020"}                                                                                                                                             | ["Title","MainSubject","AwardingBody","Month","Year"]                                                                                  |
            | [{ "Title": "Degree 1", "MainSubject": "Math", "AwardingBody": "University A", "Month": "June","Year": "2020" }, { "Title": "Degree 2", "MainSubject": "Science","AwardingBody": "University B",    "Month": "July",    "Year": "2021"    }    ] | ["0.Title", "0.MainSubject", "0.AwardingBody", "0.Month", "0.Year", "1.Title", "1.MainSubject", "1.AwardingBody", "1.Month", "1.Year"] |

    Scenario Outline: DATAMAPPER-GETNESTEDKEYS-002 - DataMapper method Get nested keys from various predefined objects
        Given I have the predefined object "<objectName>"
        When I call the DataMapper getNestedKeys method
        Then I should get the following nested property paths:
            """
            <expectedKeys>
            """

        Examples:
            | objectName                    | expectedKeys                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
            | TestData_TopazApplicant       | ["PID", "Scheme", "Profile.Forenames", "Profile.Initials", "Profile.Surname", "Profile.Email", "Profile.Gender", "Profile.DateOfBirth", "Profile.HomeNumber", "Profile.MobileNumber", "PostCode", "FeePaidStatus", "FeeType", "FeePaid", "TotalFee", "PaymentAmount", "RefundAmount", "PersonalStatement", "ReferenceDetails.RefereeName", "ReferenceDetails.Post", "ReferenceDetails.Organisation", "ReferenceDetails.Address.AddressLines.1", "ReferenceDetails.Address.AddressLines.2", "ReferenceDetails.Address.AddressLines.3", "ReferenceDetails.Address.AddressLines.4", "ReferenceDetails.Address.PostCode", "ReferenceDetails.Telephone", "ReferenceDetails.Fax", "ReferenceDetails.Email", "ReferenceDetails.ReferenceText", "ApplicantOtherDetails.OtherPersonalDetails.HomeAddress.AddressLines.1", "ApplicantOtherDetails.OtherPersonalDetails.HomeAddress.AddressLines.2", "ApplicantOtherDetails.OtherPersonalDetails.HomeAddress.AddressLines.3", "ApplicantOtherDetails.OtherPersonalDetails.HomeAddress.PostCode", "ApplicantOtherDetails.OtherPersonalDetails.HomeAddress.Country", "ApplicantOtherDetails.OtherPersonalDetails.SecondEmail", "ApplicantOtherDetails.OtherPersonalDetails.ParentalOccupation", "ApplicantOtherDetails.OtherPersonalDetails.PrefferredFirstName", "ApplicantOtherDetails.OtherPersonalDetails.PreviousSurname", "ApplicantOtherDetails.OtherPersonalDetails.ResidentialStatus", "ApplicantOtherDetails.OtherPersonalDetails.AreaOfPermanentResidence", "ApplicantOtherDetails.OtherPersonalDetails.CountryOfBirth", "ApplicantOtherDetails.OtherPersonalDetails.Nationality", "ApplicantOtherDetails.OtherPersonalDetails.DualNationality", "ApplicantOtherDetails.OtherPersonalDetails.LivedOrWorkedEU", "ApplicantOtherDetails.OtherPersonalDetails.ParentEUNational", "ApplicantOtherDetails.OtherPersonalDetails.DateOfUKEntry", "ApplicantOtherDetails.OtherPersonalDetails.OutputLanguage", "ApplicantOtherDetails.OtherPersonalDetails.LargeFontRequired", "ApplicantOtherDetails.OtherPersonalDetails.NationalId1", "ApplicantOtherDetails.OtherPersonalDetails.NationalId2", "ApplicantOtherDetails.OtherMisc01Details.ScottishCandidateNumber", "ApplicantOtherDetails.OtherMisc01Details.BTECRegistration", "ApplicantOtherDetails.OtherMisc01Details.StudentSupportArranagements", "ApplicantOtherDetails.OtherMisc01Details.LA", "ApplicantOtherDetails.OtherMisc01Details.FeeCode", "ApplicantOtherDetails.OtherMisc01Details.BeenInCare", "ApplicantOtherDetails.OtherMisc01Details.TimeInCare", "ApplicantOtherDetails.OtherMisc01Details.IdentifiesAsTransgender", "ApplicantOtherDetails.OtherMisc01Details.IELTS", "ApplicantOtherDetails.OtherMisc01Details.TOEFL", "ApplicantOtherDetails.OtherMisc01Details.DIDS4Digit", "ApplicantOtherDetails.OtherMisc01Details.DIDS16Digit", "ApplicantOtherDetails.OtherMisc01Details.Disability", "ApplicantOtherDetails.OtherMisc01Details.SpecialNeeds", "ApplicantOtherDetails.OtherMisc01Details.Dependants", "ApplicantOtherDetails.OtherMisc01Details.EthnicOrigin", "ApplicantOtherDetails.OtherMisc01Details.Religion", "ApplicantOtherDetails.OtherMisc01Details.SexualOrientation", "ApplicantOtherDetails.OtherMisc01Details.CriminalConviction", "ApplicantOtherDetails.OtherMisc01Details.DBSCheck", "ApplicantOtherDetails.OtherMisc01Details.ISANumber", "ApplicantOtherDetails.OtherMisc01Details.ParentalHE", "ApplicantOtherDetails.OtherMisc01Details.UnavailableInterviewDates", "ApplicantOtherDetails.PassportDetails.StudentVisaRequired", "ApplicantOtherDetails.PassportDetails.PassportNumber", "ApplicantOtherDetails.PassportDetails.PassportPlaceOfIssue", "ApplicantOtherDetails.PassportDetails.PreviouslyStudiedInUkOnStudentVisa", "ApplicantOtherDetails.PassportDetails.PassportIssueDate", "ApplicantOtherDetails.PassportDetails.PassportExpiryDate", "ApplicantOtherDetails.PassportDetails.SettledInUK", "ApplicantOtherDetails.OtherMisc02Details.NationalInsuranceNumber", "ApplicantOtherDetails.OtherMisc02Details.PrefferredRegion", "ApplicantOtherDetails.OtherMisc02Details.DeptHealthRegistration", "ApplicantOtherDetails.OtherMisc02Details.SchoolCode", "ApplicantOtherDetails.OtherMisc02Details.ProgressFile", "ApplicantOtherDetails.OtherMisc02Details.SLCStudentFinanceApplying", "ApplicantOtherDetails.OtherMisc02Details.SAASStudentFinanceApplying", "ApplicantOtherDetails.OtherMisc02Details.EarliestStart", "ApplicantOtherDetails.OtherMisc02Details.SecondmentPlace", "ApplicantOtherDetails.OtherMisc02Details.IndefiniteUKLeave", "ApplicantOtherDetails.OtherMisc02Details.LastEstablishment", "ApplicantOtherDetails.OtherMisc02Details.SLCStudentFinanceShareDetails", "ApplicantOtherDetails.OtherMisc02Details.SAASStudentFinanceShareDetails", "ApplicantOtherDetails.OtherMisc02Details.NearestEdInstitution", "ApplicantOtherDetails.OtherMisc02Details.EligibleForNHSBursary", "ApplicantOtherDetails.OtherMisc02Details.SelfFunding", "ApplicantOtherDetails.OtherMisc02Details.TTANumber", "ApplicantOtherDetails.OtherMisc02Details.TTAMatchingAllowed", "ApplicantOtherDetails.OtherMisc02Details.StudentFinanceReminder", "ApplicantOtherDetails.OtherEducationDetails.SchoolCollegeAndUniversityEducation.JnrDepartmentAcademy", "ApplicantOtherDetails.OtherEducationDetails.AdditionalEducation.NAGTY", "ApplicantOtherDetails.OtherEducationDetails.AdditionalEducation.HIQE", "ApplicantOtherDetails.OtherEducationDetails.AdditionalEducation.HighestExpectedQualification", "ApplicantOtherDetails.OtherEducationDetails.AdditionalEducation.ULN", "ApplicantOtherDetails.OtherEducationDetails.AdditionalEducation.HIQA", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.NameOfInstitution", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.Title", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.Class", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.TitleOfCourse", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.EntryMonth", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.EntryYear", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.CompletionMonth", "ApplicantOtherDetails.OtherEducationDetails.FirstDegreeOrEquivalent.CompletionYear", "ApplicantOtherDetails.OtherEducationDetails.AdditionalUCASTeacherTrainingInformation.ProfessionalSkillsTestRegistration", "ApplicantOtherDetails.OtherEducationDetails.AdditionalUCASTeacherTrainingInformation.DateOfNumeracyTest", "ApplicantOtherDetails.OtherEducationDetails.AdditionalUCASTeacherTrainingInformation.UTTHighestExpectedQualification", "ApplicantOtherDetails.OtherEducationDetails.AdditionalUCASTeacherTrainingInformation.ProfessionalSkillsTestRegistrationNumber", "ApplicantOtherDetails.OtherEducationDetails.AdditionalUCASTeacherTrainingInformation.DateOfLiteracyTest", "ApplicantOtherDetails.CatchQuestions.NationalInsuranceNumber", "ApplicantOtherDetails.CatchQuestions.CATCHQuestionsAsked", "ApplicantOtherDetails.CatchQuestions.NMCPIN", "ApplicantOtherDetails.EmergencyContact.ContactName", "ApplicantOtherDetails.EmergencyContact.PhoneNumber", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.Disability", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.DisabilityFurtherDetails", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.OfficialRefugeeStatus", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.FreeSchoolMeals", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.EstrangedFromParents", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.ParentingResponsibilities", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.CaringResponsibilities", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.ParentInArmedForces", "MoreAboutYouAndExtraActivities.MoreAboutYouDetails.UKArmedForces", "DataUpdates.ReferenceDetails.RefereeName", "DataUpdates.ReferenceDetails.Post", "DataUpdates.ReferenceDetails.Telephone", "DataUpdates.ReferenceDetails.Fax", "DataUpdates.ReferenceDetails.Email", "DataUpdates.ReferenceDetails.Organisation", "DataUpdates.ReferenceDetails.Address.PostCode", "DataUpdates.ReferenceDetails.ReferenceText"] |
            | TestData_UkAddress            | ["AddressLines.1","AddressLines.2","AddressLines.3","AddressLines.4","PostCode"]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
            | TestData_sampleObjectArray    | ["0.Title","0.MainSubject","0.AwardingBody","0.Month","0.Year","1.Title","1.MainSubject","1.AwardingBody","1.Month","1.Year"]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
            | TestData_UkAddressWithCountry | ["AddressLines.1","AddressLines.2","AddressLines.3","PostCode", "Country"]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |